# Charon Overview
The Charon project provides a set of tools to build a computing infrastructure where user applications run on the Charon software stack. The software stack offers container runtime, system and application performance monitoring, and a control plane controlling the applications to meet given requirements. The goal of the project includes,
- Creating a computing cluster on top of Kubernetes for distributed comtputing environment
- Establishing a data pipeline for system and application metrics for a controller to consume and control
- Enabling custom controllers to study resource management strategies.

This repository contains [scripts](ansible/) to provision a set of computing machines and build a Kubernetes (k3s) cluster using the machines. Then, you can tap into Grafana dashboard on the master node of the cluster to monitor performance of the system and any applications you launch in the Kubernetes cluster. You can also develop and deploy your controller to handle user applications based on the system and application performance. The [data] directory holds a few datasets collected from experiments.

# CharonControl

[**CharonCtl**](docs/charonctl.md) is an interactive command-line interface that serves as the central management tool for Charon infrastructure and distributed computing workflows. It provides a unified interface for provisioning computing clusters through Ansible automation, deploying and managing Numaflow data pipelines on Kubernetes, executing direct kubectl operations, and collecting performance metrics from Prometheus servers. With features like auto-completion, secure credential handling, and support for both local and remote operations, charonctl streamlines the entire lifecycle of distributed computing infrastructure—from initial cluster provisioning to workload deployment and performance monitoring—enabling researchers and developers to focus on their computational work rather than infrastructure complexity.

# Get Started with Example

The best way to learn a tool is often through an end-to-end example. We provide [a comprehensive example](examples/aps-ptychonn.md) that illustrates a scientific workflow for ptychography imaging in beamline.

## Provisioning a Computing Cluster
Please refer to the [README](ansible/README.md) for details.

## Install Node Resource Manager for Publishing Metrics

> WARNING: We deprecated using NRM and moved into Kubernetes-native controllers.

Argonne's Node Resource Manager (NRM) publishes data pushed from data sources. To run,

```bash
# Run the following command inside the machine
kubectl -n charon apply -f ansible/kubernetes/nrm.yaml
kubectl -n charon apply -f ansible/kubernetes/nrm-k3s.yaml
```

To validate the NRM instance,
```bash
nrmc listen
```

You should see a heartbeat message from the NRM instance,
```bash
event: 1738868720562817129 daemon.tick nrm.hwloc.Machine.0 1.000000
event: 1738868721562980582 daemon.tick nrm.hwloc.Machine.0 1.000000
```

## Developer Notes
Some useful developer notes and a list of todo items for improvement can be found [here](TODO.md).

## Acknowledgement

The Go code and associated documents in this repository were generated by GitHub Copilot with the Claude Sonnet 4 model, and were improved and tested by human contributors.